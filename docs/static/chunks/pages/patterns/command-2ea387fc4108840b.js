(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[34],{1521:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/patterns/command",function(){return s(9537)}])},9537:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return j}});var n=s(5893),l=s(1151),r=s(7294);let o=()=>{let e=r.useContext(x),t=r.useRef([]),s=(s,n)=>{let l=s(e);t.current.push(l),l.execute(n)},n=()=>{let e=t.current.pop();e&&e.undo()};return{execute:s,undo:n}},i=e=>{let t;let s=()=>{var t;let s=null===(t=e.list.sort((e,t)=>t.key-e.key)[0])||void 0===t?void 0:t.key;return"number"==typeof s?s+1:1},n=n=>{t=e.list;let l=s();e.setList([...e.list,{todo:n,key:l,status:"todo"}]),e.setValue("")},l=()=>{t&&e.setList(t)};return{execute:n,undo:l}},a=e=>{let t;let s=s=>{t=e.value,e.setValue(s)},n=()=>{t&&e.setValue(t)};return{execute:s,undo:n}},c=e=>{let t;let s=s=>{t=e.list;let n=e.list.filter(e=>e.key!==s);e.setList(n)},n=()=>{t&&e.setList(t)};return{execute:s,undo:n}},u=e=>{let t;let s=s=>{t=e.list;let n=e.list.map(e=>e.key===s?{...e,status:"finished"}:e);e.setList(n)},n=()=>{t&&e.setList(t)};return{execute:s,undo:n}},d=e=>{let{style:t,showUndo:s=!1}=e,{list:l,value:d}=r.useContext(x),{execute:h,undo:p}=o(),j=e=>{h(c,e)},f=e=>{h(u,e)},m=e=>{h(i,e)},g=e=>{h(a,e)},b=()=>{p()},k=e=>{"Enter"===e.code&&m(d)};return(0,n.jsxs)("div",{className:"not-prose",style:t,children:[(0,n.jsx)("div",{className:"mt-5",children:s&&(0,n.jsx)("button",{onClick:b,className:"bg-orange-700 text-white px-3 rounded-lg text-lg cursor-pointer font-bold",children:"UNDO"})}),(0,n.jsx)("input",{placeholder:"Press Enter to add a new TODO",type:"text",onKeyDown:k,className:"h-12 rounded-2xl pl-5 text-2xl border-orange-500 border-2 border-solid mt-5 w-full",value:d,onChange:e=>g(e.target.value)}),(0,n.jsx)("ul",{className:"w-full text-2xl mt-5",children:l.map(e=>(0,n.jsxs)("li",{className:"py-2 flex justify-between border-2 px-4 rounded-lg items-center mb-4",children:[(0,n.jsx)("span",{className:"font-bold ".concat("finished"===e.status?"line-through text-gray-400":""),children:e.todo}),(0,n.jsxs)("div",{className:"text-lg",children:[(0,n.jsx)("span",{className:"cursor-pointer text-orange-500 font-bold",onClick:()=>j(e.key),children:"DELETE"}),(0,n.jsx)("span",{className:"ml-5 cursor-pointer text-pink-500 font-bold",onClick:()=>f(e.key),children:"FINISH"})]})]},e.key))})]})},x=r.createContext({value:"",list:[],setList(){},setValue(){}});function h(e){let{defaultTodo:t,style:s}=e,[l,o]=r.useState(""),[i,a]=r.useState([]);return r.useEffect(()=>{t&&a(t)},[t]),(0,n.jsx)(x.Provider,{value:{value:l,list:i,setList:a,setValue:o},children:(0,n.jsx)(d,{style:s})})}function p(e){let t=Object.assign({h1:"h1",p:"p",code:"code",strong:"strong"},(0,l.ah)(),e.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.h1,{children:"Command Pattern"}),"\n",(0,n.jsx)(t.p,{children:"命令模式是一种将行为具象化的设计模式。所谓的“具象化”，其实就是把函数用对象包了一层。"}),"\n",(0,n.jsx)(t.p,{children:"不过，在 JS 中，函数其实也是个对象，所以这一点体现并不明显。"}),"\n",(0,n.jsx)(t.p,{children:"命令模式在恰当的场景中能取得相当好的效果，让事情变得无比简单。而且并不需要很复杂的代码逻辑，反而能让你的代码变得更加清晰易懂。"}),"\n",(0,n.jsx)(t.p,{children:"想象这样一个场景——一个简单的 TODO List 应用："}),"\n",(0,n.jsx)(h,{defaultTodo:[{todo:"something to do",key:1,status:"todo"}]}),"\n",(0,n.jsxs)(t.p,{children:["你可以在输入框中输入一些你要做的事情，然后按 ",(0,n.jsx)(t.code,{children:"Enter"})," 添加这个 TODO 到列表中。对于列表中的 TODO，你可以选择删除或者完成它们。"]}),"\n",(0,n.jsxs)(t.p,{children:["很简单的一个需求程序，当你轻轻松松写完之后，产品却突然加了个新功能——",(0,n.jsx)(t.strong,{children:"用户需要撤回操作！"})]})]})}var j=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:t}=Object.assign({},(0,l.ah)(),e.components);return t?(0,n.jsx)(t,Object.assign({},e,{children:(0,n.jsx)(p,e)})):p(e)}}},function(e){e.O(0,[774,888,179],function(){return e(e.s=1521)}),_N_E=e.O()}]);